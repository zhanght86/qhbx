F.module("/static/browse/ui/related-list/related-list.js",function(c,a){var b=c("/static/common/lib/tangram/base/base.js");function d(){var e=this;e.show=function(g,i){if(!i){return}var f=b(g).position();var h=b(".related-category",g).first();h.css({left:f.left+i.left+8,top:f.top+i.top+1});h.addClass("related-box")};e.hide=function(f){b.dom(".related-category",f).each(function(g,h){b(h).removeClass("related-box")})};e.selectAble=function(f,h,k){var j=b(f).get(0);e.pos=k;if(typeof h=="string"){var g=b(h,j);b.forEach(g,function(o){i(o)})}else{var m=b(".related-category",j).get(0);var l=b.dom(m).parent().get(0);var n=(typeof h=="object")?h:e.pos;b.dom(l).mouseenter(function(o){e.show(l,n);b.dom(m).css("display","block")});b.dom(l).mouseleave(function(o){e.hide(l);b.dom(m).css("display","none")});i(l)}function i(r){var o=b.dom(".related-category",r);var q=0;if(o.length>0){var s=b.dom("dl",r).get(0);b(s).mouseenter(function(t){if(q){clearTimeout(q)}e.show(r,e.pos)});b(s).mouseleave(function(t){q=setTimeout(function(){e.hide(r)},100)});var p=b(s).children();b.forEach(p,function(t){b(t).mouseenter(function(u){b(this).css("background-color","#EBEBEB")});b(t).mouseleave(function(u){b(this).css("background-color","")})})}}}}a=d;return a},["/static/common/lib/tangram/base/base.js"]);
F.module("/static/browse/ui/fixed-ask/fixed-ask.js",function(f,c){var e=f("/static/common/lib/tangram/base/base.js"),g=f("/static/common/ui/dialog/dialog.js"),d=f("/static/common/ui/event/event.js"),b=b||{};function a(){var h=this;h.FixedAsk=function(j){var i;e.sio("/iask/api/ikhelplimit?un="+j+"&t="+(new Date()).getTime()).callByServer(b.show=function(l){if(!l||l.status!=0){return}var o=l.data;var q=o.replyLimit;var n=o.replyMaxNum;var m=o.ifLogin;var k=o.ifUsernameOK;if(k==0){var p="<div style='text-align:left;line-height:22px'>对不起！此用户不存在</div>";g.alert(p,{height:150});return false}if(n==0||q<=0){var p="<div style='text-align:left;line-height:22px'>对不起！此用户暂时无法接收提问求助，您可以换一位用户试试。</div>";g.alert(p,{height:150});return false}if(m==0){d.fire("login.log",{onLoginSuccess:function(){location.href="http://zhidao.baidu.com/new?fix="+j+"&tn=ikask"}});return false}else{location.href="http://zhidao.baidu.com/new?fix="+j+"&tn=ikask"}})}}c=new a();return c},["/static/common/lib/tangram/base/base.js","/static/common/ui/dialog/dialog.js","/static/common/ui/event/event.js"]);
F.module("/static/browse/ui/position-select/position-select.js",function(d,a){var c=d("/static/common/lib/tangram/base/base.js"),e=d("/static/common/ui/baidu/fx/fx.js"),b=d("/static/common/ui/event/event.js");function f(){var l=this,k=[];l.init=function(x,p){var q="",v="",C=c.cookie.get("IK_SELECTEDPOINT"),u=C!=null,r=k.slice(0);for(var t=0,w=r.length;t<w;t++){var A=r[t].areaname,s=(t?"|":"")+A+","+r[t].lng+","+r[t].lat;q+=s;if(u&&C.search(A+",")==-1){l.del(A)}else{v+=h(A,r[t].lng,r[t].lat,"delete");u&&(C=C.replace(new RegExp("\\|?"+A+"\\S+?(?=\\||$)"),""))}}var y=Number(C)!=0?C.replace(/^\|/,""):"";if(y){var s=y.split("|");for(var t=0;t<s.length;t++){var B=s[t].split(",");k.push({areaname:B[0],lng:B[1],lat:B[2]});v+=h(B[0],B[1],B[2],"delete")}}if(v){c("#selected").empty().append(c("<ul></ul>").html(v))}c.cookie.remove("IK_SELECTEDPOINT",{path:"/browse/"});var z=c(x).get();m(z,p);c.forEach(z,function(D){c(D).on("click",function(H){c.event(H).preventDefault();switch(o(D)){case"add":var G=c.dom(D).attr("data-name"),E=false;c.forEach(k,function(K,J){if(G==K.areaname){var I=c.dom.getAncestorByTag(D,"li");c.dom.remove(I);E=true}});if(E){return}i(D,"delete");k.push({areaname:G,lat:c(D).attr("data-lat"),lng:c(D).attr("data-lng")});j(D);m(z,p);break;case"delete":i(D,"add");n(c(D).attr("data-name"));c.dom(D.parentNode).remove();m(z,p,true);break}b.fire("poi-click")})})};l.getHot=function(s,q,p,t){var r="http://map.baidu.com/?qt=sub_area_list&areacode="+s+"&level=1&business_flag=1&from=zhidao&ie=gbk&callback=getHotCallback&t="+Math.random();c.sio.callByServer(r);window.getHotCallback=function(z){if(z.content==undefined){return}var u=z.content.sub,B="";if(u){var C=(u.length>p)?p:u.length;for(var A=0;A<C;A++){var w=u[A]["area_name"],y=u[A]["geo"].split(","),x=y[0].slice(2),v=y[y.length-1].slice(0,-1);B+=h(w,x,v,"add")}t(B)}else{g(s,t,function(D){l.getHot(D.area_code,q,p,t)})}}};function h(q,s,t,r){var p='<li><a href="#" class="poi-item poi-'+r+'" data-lng="'+s+'" data-lat="'+t+'" data-name="'+q+'"><span class="text">'+q+'</span><span class="icon"></span></a></li>';return p}function j(A){var s=c("#selected");var z=c("#selected .placeholder");if(z.length>0){c.dom(z.get(0)).remove();s.append(c("<ul></ul>").get(0))}s=s.children().first();var r=c(A).position();c.dom(A).css({position:"absolute",top:r.top,left:r.left});var p=c(s).children();var u=c(s).position();var q=u.left;var v=u.top;if(p.length>0){u=c(p[p.length-1]).position();q=u.left+p[p.length-1].offsetWidth+15}var w=parseInt(c.dom(A).css("left"))||0;var t=parseInt(c.dom(A).css("top"))||0;e.moveBy(A,[q-w,v-t],{duration:300,onafterfinish:function(){c(s).append(A.parentNode);c(A).css("position","")}})}function g(r,q,s){var p="http://map.baidu.com/?qt=sub_area_list&areacode="+r+"&level=1&from=zhidao&tn=m01&ie=gbk&l=12&t="+Math.random();c.sio(p).callByServer("getAreaCallback");window.getAreaCallback=function(u){var t=u.content.sub;if(t){s(t[parseInt(Math.random()*t.length)])}else{q('<li class="nohotspot"><p>该地点系统暂无热门地点</p></li>')}}}l.insert=function(p){k=k.concat(p)};l.del=function(p){n(p)};l.getSelected=function(){return k};l.submit=function(p){if(p){k=p}if(k.length==0){return}var q=[],s=[],r=[];c.array.each(k,function(u){q.push(encodeURIComponent(u.areaname));s.push(u.lat);r.push(u.lng)});var t=["cm=100541","areaname="+q.join(","),"bdlat="+s.join(","),"bdlng="+r.join(",")];b.fire("login.check",{isLogin:function(){c.post("/submit/user",t.join("&"),function(v){var u=c.json.parse(v);if(u.errorNo==0){setTimeout(function(){location.href="/browse/1?force=2"},300)}else{}},"html")}})};function m(q,p,r){if(k.length<p){if(r&&(p-k.length)==1){c.forEach(q,function(s){if(o(s)=="disabled"){i(s,"add")}})}return}c.forEach(q,function(s){if(o(s)=="add"){i(s,"disabled")}})}function n(p){var r=0;for(var q=0;q<k.length;q++){if(k[q]["areaname"]==p){r=q;break}}k.splice(r,1)}function o(p){return(c.dom(p).hasClass("poi-delete"))?"delete":c.dom(p).hasClass("poi-disabled")?"disabled":"add"}function i(r,p){var q=o(r);c.dom(r).removeClass("poi-"+q);c.dom(r).addClass("poi-"+p)}return l}a=new f();return a},["/static/common/lib/tangram/base/base.js","/static/common/ui/baidu/fx/fx.js","/static/common/ui/event/event.js"]);
F.module("/static/browse/ui/show-map/show-map.js",function(c,a){var b=c("/static/common/lib/tangram/base/base.js");function d(){var e=this,h={};e.init=function(i){b(i).each(function(k,l){var j=false;b(l).on("click",function(m){b.event(m).preventDefault();b.event(m).stopPropagation();j=!j;if(!j){var n=b(".map-pop")[0];b(n).hide().remove();return}h.lat=b(l).attr("data-lat");h.lng=b(l).attr("data-lng");if(h.container){b(h.container).remove();h.container=null}h.container=g(l);f(e.renderMap)})})};e.renderMap=function(){var l=new BMap.Map(b(".map-pop-contain",h.container)[0]),j=new BMap.Point(h.lng,h.lat);l.centerAndZoom(j,15);var i=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_SMALL});l.addControl(i);var k=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});l.addControl(k);l.addEventListener("tilesloaded",function(){l.addOverlay(new BMap.Marker(j))})};function g(k){var j=b.dom('<div id="poi-map-'+b.lang.guid()+'" class="map-pop"></div>');j.html('<div class="map-pop-head"></div><div class="map-pop-body"><div class="map-pop-contain"></div></div>');var i=b(k).position();j.css({top:i.top+18,left:i.left-36+k.offsetWidth/2});document.body.appendChild(j.get(0));b(document).on("click",function(m){var l=b.event(m).target;if(!j.contains(l)){j.hide().remove()}});return j.get(0)}function f(i){if(typeof BMap=="undefined"){b.sio("http://api.map.baidu.com/api?v=1.3").callByServer(function(){e.renderMap()})}else{i()}}}a=new d();return a},["/static/common/lib/tangram/base/base.js"]);
F.module("/static/browse/ui/quick-answer/quick-answer.js",function(b,h){var a,e=b("/static/common/lib/tangram/base/base.js"),g=b("/static/common/ui/log/log.js"),i=b("/static/common/ui/ut/ut.js"),j=b("/static/common/ui/event/event.js"),d=b("/static/common/ui/store/store.js"),c=b("/static/common/ui/baidu/fx/fx.js"),m=b("/static/common/ui/submit/submit.js"),l=b("/static/common/ui/dialog/dialog.js"),f=F.context("user");var k=e.createClass(function(){var w=this,x=null,o,y={id:"quick-answer-area",tip:"助人为快乐之本，第一时间来帮TA",qid:F.context("qid"),cid:F.context("cid"),onQuickSubmit:function(){}},s='<div class="answerarea" info="0" id="#{id}" style="display:none;"></div>',A='<p class="qdesc">#{qdesc}</p>',z='<textarea class="quickanswer-edit" name="quickanswer-edit" tip="#{tip}"></textarea>',t='<p class="quicksubinfo"></p>',r='<span class="quick-error-tip"></span>',v='<input class="anoy" type="checkbox"/><span>匿名</span>',n='<a qid=#{qid} cid=#{cid} class="quicksub btn btn-32-green"><em><b>提交回答</b></em></a>';w.init=function(C){w.opts=e.extend(y,C||{});var B=p();e(".quicksub",B.get(0)).each(function(E,D){e(D).on("click",w.opts.onQuickSubmit)});j.on("quickAnswerArea.close",function(D){if(B.attr("info")==1){B.attr("info",0);c.collapse(B.get(0),{duration:300});g.send({type:2040,quick_answer_box:"collapse"})}});q(e(".quickanswer-edit",B.get(0)).get(0));return B};w.replaceVal=function(B){if(typeof B!=="string"){return false}B=e.string(B).replace(e.regexp("#{([a-z0-9_-]+)}","g"),u);return B};function q(B){e(B).on("focus",function(){if(e(this).val()==w.opts.tip){e(this).val("")}e(this).css({color:"#000",border:"1px solid #60A506"})});e(B).on("blur",function(){if(!e(this).val()){e(this).val(w.opts.tip)}if(e(this).val()==w.opts.tip){e(this).css({color:"#acacac"})}e(this).css({border:"1px solid #CCC"})});if(e.ie){e(B).on("propertychange",function(){if(e(this).val()!=""){e(B).next().find(".quick-error-tip").first().html("")}return})}else{e(B).on("input",function(){e(B).next().find(".quick-error-tip").first().html("");return})}}function u(B,C){if(C in w.opts){return w.opts[C]}return""}function p(){var C=e(w.replaceVal(s));C.append(w.replaceVal(A));C.append(w.replaceVal(z));var B=e(w.replaceVal(t));B.append(w.replaceVal(r));B.append(w.replaceVal(v));B.append(w.replaceVal(n));C.append(B);return C}});a=function(){var n={},t=this,u,v={container:".qlist-tr td",placeholder:"助人为快乐之本，第一时间来帮TA",errorTip:"请您输入文字内容",hover:"",onSubmitSuccess:function(x,w){}};t.init=function(w){t.opts=e.object.extend(v,w);u=q();e(t.opts.container).each(function(A,z){var B=new k(),y="quick-answer-"+e(z).attr("qid"),C=e(z).attr("qdesc"),D=e(z).find(".title").first().attr("href");if(e.string(C).getByteLength()>54){C=e.string(e.string(C).encodeHTML()).subByte(54)+'...<a target="_blank" href="'+D+'" alog-action="more_click">详情</a>'}e(z).append(B.init({id:y,qdesc:C,qid:e(z).attr("qid"),cid:e(z).attr("cid"),onQuickSubmit:t.quickSubmit}));var x;if(e.array(u).contains(e(z).attr("qid"))){x=e('<span class="haveAnswered">已回答</span>')}else{x=e('<input alog-action="br-quick-btn"  type="button" class="quickbtn" />');j.on("quickAnswerBtn.close",function(){r(z);x.removeClass("quickbtn-click")});x.on("click",function(E){if(e("#"+y).attr("info")==0){j.fire("quickAnswerBtn.close");j.fire("quickAnswerArea.close");e("#"+y).attr("info",1);r(z);e(this).addClass("quickbtn-click");c.expand(e("#"+y).get(0),{duration:150});e("#"+y+" textarea").each(function(H,G){G.focus()});g.send({type:2040,quick_answer_box:"expand"})}else{j.fire("quickAnswerBtn.close");j.fire("quickAnswerArea.close")}})}e(z).prepend(x);if(t.opts.hover==""){e(z).mouseenter(function(E){e(z).addClass("td-hover");e(z).css("visibility","visible")});e(z).mouseleave(function(E){e(z).removeClass("td-hover");e(z).css("visibility","")})}});if(typeof t.opts.hover=="string"&&t.opts.hover!=""){e(t.opts.hover).each(function(y,x){e(x).mouseenter(function(z){e(x).addClass("td-hover");e(x).css("visibility","visible")});e(x).mouseleave(function(z){e(x).removeClass("td-hover");e(x).css("visibility","")})})}if(s()){e(t.opts.container).find(".quickbtn").first().trigger("click")}};t.quickSubmit=function(x){var z=e(e.event(x).target);var w=z.parents("td").get(0);var y=e("textarea",w).first().val();if(e.string(y).trim()==""||y==t.opts.placeholder){e("textarea",w).get(0).focus();e(".quick-error-tip",w).first().html(t.opts.errorTip);return}j.fire("login.check",{isLogin:function(){p(z);g.send({type:2040,submit_click:"click",has_login:1})},noLogin:function(){j.fire("login.log",{onLoginSuccess:function(){p(z)}})}})};function r(z){var y=e("a",z).first(),w=e.string(e.string(y.attr("title")).trim()).encodeHTML(),A=e.string(y.html()).trim(),x=y.nextAll(".answerarea").first();if(x.length&&x.attr("info")==1){if(y.attr("_qtitle")&&e.string(y.attr("_qtitle")).trim()!=""){w=e.string(y.attr("_qtitle")).trim();y.attr("_qtitle","")}y.attr("_qtitle",A);y.html(w)}}function p(z){var w=z.parents("td").get(0);var A=e(w).attr("qid");var y=e("textarea",w).first().val();var x={cm:100009,qid:A,cid:e(w).attr("cid"),path:"/question/"+A+".html",co:y,fr:"qlquick",utdata:i.report()["c"]};if(e(".anoy",w).get(0).checked){x.anoy=1}new m({url:"/submit/ajax",params:x,beforeJump:function(H,G,E){var C='<div style="text-align:center;font-size:16px;">								  	<p>										<span style="background:url(http://img.baidu.com/img/iknow/ql/quick-answer.gif) transparent 0 0 no-repeat;display:inline-block;width: 27px;height: 30px;vertical-align: middle;"></span>										<span>您的回答已成功提交</span>									</p>									<p>										<span style="background:url(http://img.baidu.com/img/iknow/ql/quick-answer.gif) transparent -5px -41px no-repeat;width: 15px;height: 15px;display: inline-block;vertical-align: middle;"></span>										<span>经验值+2</span>									</p>								  </div>',B='<div style="text-align:center;font-size:16px;">								  	<p>										<span style="background:url(http://img.baidu.com/img/iknow/ql/quick-answer.gif) transparent 0 0 no-repeat;display:inline-block;width: 27px;height: 30px;vertical-align: middle;margin-left: -24px;"></span>										<span style="margin-left: 5px;">您的回答正在自动提交中</span>									</p>									<p>										<span style="margin-left: 44px;">非常感谢您帮助提问者解决！</span>									</p>								  </div>';if(G.check==1){o(B)}else{o(C)}t.opts.onSubmitSuccess(z.parents(".qlist-tr").get(0),G);var D=d.get("answerData");d.set("answerData",D?(D+"|"+A):A);j.fire("quickAnswerArea.close");j.fire("quickAnswerBtn.close")}})}function o(w){l.alert(w)}function q(){var x=[],w;if(f.isLogin&&(w=d.get("answerData"))){x=w.split("|")}else{d.remove("answerData")}return x}function s(){var y=e.cookie.get("BAIDUID")||"";var w="quick"+(y.split(":")[0]||"123456789");var x=d.get(w)?d.get(w):0;if(!x){d.set(w,1);return true}else{return false}}};h=a;return h},["/static/common/lib/tangram/base/base.js","/static/common/ui/log/log.js","/static/common/ui/ut/ut.js","/static/common/ui/event/event.js","/static/common/ui/store/store.js","/static/common/ui/baidu/fx/fx.js","/static/common/ui/submit/submit.js","/static/common/ui/dialog/dialog.js"]);F.module("/static/widget/browse/path/path.js",function(e,b){var d=e("/static/common/lib/tangram/base/base.js"),c=e("/static/common/ui/set-care-field/set-care-field.js"),g=new c(),a=e("/static/browse/ui/related-list/related-list.js"),f=e("/static/common/ui/log/log.js");if(d("#path-set-class")){d("#path-set-class").on("click",function(h){g.init({expand:"onlyCid",defaultCid:F.context("cid")||0});f.send({pid:102,url:location.href,type:2013,clickcate:"clickcate"})})}(new a()).selectAble("#path",{left:1,top:3});return b},["/static/common/lib/tangram/base/base.js","/static/common/ui/set-care-field/set-care-field.js","/static/browse/ui/related-list/related-list.js","/static/common/ui/log/log.js"]);
F.module("/static/widget/browse/expert/expert.js",function(c,a){var b=c("/static/common/lib/tangram/base/base.js"),g=c("/static/browse/ui/fixed-ask/fixed-ask.js"),f=b("#expert-panel .d-gride"),d=f.get(0);f.each(function(h,i){b(i).on("mouseover",function(){b(d).removeClass("d-gride-hover");b(i).addClass("d-gride-hover");d=i})});var e=b("#expert-panel .fixdask-e");b.forEach(e,function(h){b(h).on("click",function(j){var i=b(this).attr("rel");g.FixedAsk(i);b.event(j).preventDefault()})});return a},["/static/common/lib/tangram/base/base.js","/static/browse/ui/fixed-ask/fixed-ask.js"]);
F.module("/static/widget/browse/category/category.js",function(c,b){var a=c("/static/browse/ui/related-list/related-list.js");b.init=function(){(new a()).selectAble(".top-box","li",{left:-1,top:3})};return b},["/static/browse/ui/related-list/related-list.js"]);
F.module("/static/widget/browse/process/process.js",function(c,a){var b=c("/static/common/lib/tangram/base/base.js"),d=c("/static/common/ui/dialog/dialog.js"),e=F.context("cid");a.init=function(){uoperator=(function(){var h="http://"+location.host;var g=b("#process-panel .btn");b.sio(h+"/uadmin/info/permission?cid="+e).callByServer("uoperator.check");function f(i){if(i.rec_new=="0"&&i.rec_overdue=="0"&&i.rec_good=="0"){b("#process-panel").hide();return false}b("#replay-panel").hide();if(i.rec_new=="0"){b("#uo-btn-new").hide()}if(i.rec_overdue=="0"){b("#uo-btn-overdue").hide()}if(i.rec_good=="0"){b("#uo-btn-good").hide()}}g.each(function(i,j){b(j).on("click",function(){var k=b(this).attr("data-type");d({contentType:"frame",content:(h+"/uadmin/index/browse?offset=0&type="+k+"&cid="+e+"&t="+(new Date()).getTime()),titleText:"问题列表",height:440,width:700})})});return{check:f}})()};return a},["/static/common/lib/tangram/base/base.js","/static/common/ui/dialog/dialog.js"]);
F.module("/static/widget/browse/admin/admin.js",function(d,a){var c=d("/static/common/lib/tangram/base/base.js"),f=d("/static/common/lib/magic/setup/tab/tab.js");var g=c("#admin-panel .admin-category-panel .d-gride");var b=g.first();g.each(function(i,j){c(j).on("mouseover",function(){b.removeClass("d-gride-hover");c(j).addClass("d-gride-hover");b=c(j)})});var h=c("#admin-panel .admin-content-panel .d-gride");var e=h.first();c.each(h,function(i,j){c(j).on("mouseover",function(){e.removeClass("d-gride-hover");c(j).addClass("d-gride-hover");e=c(j)})});f("admin-tab",{selectEvent:"mouseover"});return a},["/static/common/lib/tangram/base/base.js","/static/common/lib/magic/setup/tab/tab.js"]);
F.module("/static/widget/browse/rank-browse/rank-browse.js",function(c,a){var b=c("/static/common/lib/tangram/base/base.js"),d=c("/static/common/lib/magic/setup/tab/tab.js");d("rank-browse-tab",{selectEvent:"mouseover"});return a},["/static/common/lib/tangram/base/base.js","/static/common/lib/magic/setup/tab/tab.js"]);
F.module("/static/widget/browse/care-field/care-field.js",function(require,exports){var iknow=iknow||{},T=require("/static/common/lib/tangram/base/base.js"),setCareField=require("/static/common/ui/set-care-field/set-care-field.js"),log=require("/static/common/ui/log/log.js"),set=new setCareField();T.sio("/ucenter/api/uccategoryrank?t="+(new Date()).getTime()).callByServer(function(data){if(!data){return}var keyword=data.keyword;var Rank=data.rank;if(T("#set-keyword")){var kw="";if(keyword.length!=0){for(var j=0;j<keyword.length;j++){if(F.context("isTag")&&(keyword[j].title==F.context("keyword"))){T("#iscat").html('<span class="c-gray">已设置为关键词</span>')}keyword[j].title=keyword[j].title.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");kw+='<a target="_blank" href="/search?ie=gbk&lm=65536&pn=0&rn=10&word='+keyword[j].url+'">'+keyword[j].title+"</a>"}}else{kw+="您还没有设置关注的关键词";T("#set-keyword").html("设置")}T("#my-carefield-keyword").html(kw);T("#set-keyword").on("click",function(e){T.event(e).preventDefault();set.init({expand:"onlyKey"});log.send({pid:102,url:location.href,type:2013,areacate:"areacate"})})}if(T("#path-set-keyword")){T("#path-set-keyword").on("click",function(e){T.event(e).preventDefault();set.init({expand:"onlyKey"});log.send({pid:102,url:location.href,type:2013,clickkey:"clickkey"})})}initAddCareBtn(data);if(T(".btn_add_care").length){T(".btn_add_care").first().on("click",function(e){T.event(e).preventDefault();submitCareInfo(data)})}if(T("#carefield-panel").length){initCareField(Rank)}function showIcon(r){var rn=parseInt(r);var p=["0","-27","-54","-81"];var l=[5,20,50,100];if(rn>l[l.length-1]){return""}for(var i=0;i<l.length;i++){if(rn<=l[i]){var top=p[i]+"px";break}}var span='<span title="回答排名" style="padding: 0px 17px;float:right;background: url(http://img.baidu.com/img/iknow/rank_icon.gif) 0 '+top+' no-repeat">&nbsp;</span>';return span}function submitCareInfo(data){var cids=[];for(var i=0;i<data.rank.length;i++){cids.push(data.rank[i].cid)}cids.push(F.context("cid"));var str_cids=cids.join("_");var keywords="";for(var i=0;i<data.keyword.length;i++){var decode=T.string.decodeHTML(data.keyword[i].title);keywords+="&kw"+i+"="+encodeURIComponent(decode)}if(data.keyword.length!=0){keywords+="&kwn="+data.keyword.length}var url="cm=100522&word="+str_cids+keywords;T.ajax({url:"/submit/user",data:url,type:"POST",dataType:"text",success:function(data){if(data){var backData=eval("("+data+")");if(backData.errorNo=="0"){setTimeout(function(){T.sio("/ucenter/api/uccategoryrank?t="+(new Date()).getTime()).callByServer(function(careData){initCareField(careData.rank)})},500);if(T("#btn_add_care").length){T("#btn_add_care").first().removeClass("btn_add_care");T("#btn_add_care").first().addClass("btn_have_cared");T("#btn_add_care").first().off("click")}}else{addCareInfoError()}}},error:addCareInfoError})}function addCareInfoError(){if(T(".add_care_error").length){T(".add_care_error").first().html("添加关注失败，请稍后再试哦")}}function initCareField(Rank){var _html=[],showLength=Rank.length,showNowCat=false;_html.push('<table cellspacing="0" cellpadding="0" width="100%" border="0" style="overflow:normal" class="may-careclass">');_html.push("<tbody>");if(showLength!=0){_html.push('<tr class="table-head"><td width="60%">分类</td>');_html.push('<td align="left"><a alog-alias="#" style="float:right;" href="#" id="setCategory">设置</a>排名</td>');_html.push("</tr>");for(var i=0;i<showLength;i++){_html.push('<tr alog-group="br-care-cate">');if(Rank[i].cid==F.context("cid")){_html.push('<td class="isCur"><span>'+Rank[i].cname+"</span></td>");showNowCat=true}else{_html.push('<td style="padding-left:2px;"><a href="/browse/'+Rank[i].cid+'?fr=qlrank" target="_blank">'+Rank[i].cname+"</a></td>")}if(Rank[i].rank==0){_html.push('<td align="left">-</td>')}else{_html.push('<td align="left">'+showIcon(Rank[i].rank)+Rank[i].rank+"</td>")}_html.push("</tr>")}}else{_html.push('<tr class="table-head"><td>分类</td></tr>');_html.push('<tr><td><a alog-alias="#" style="float:right;" href="#" id="setCategory">设置</a>您还没有设置关注的分类</td></tr>')}_html.push("</tbody></table>");T("#my-carefield-class").html(_html.join(""));if(showNowCat&&!F.context("isTag")){T("#iscat").html('<span class="c-gray">已设置为关注分类</span>')}T("#setCategory").on("click",function(e){T.event(e).preventDefault();set.init({expand:"onlyCid"});log.send({pid:102,url:location.href,type:2013,areakey:"areakey"})})}function initAddCareBtn(data){if(T("#btn_add_care").length){T("#btn_add_care").first().addClass("btn_add_care");if(data.rank.length==5){T("#btn_add_care").first().removeClass("btn_add_care");T("#btn_add_care").first().addClass("btn_care_enough")}for(var i=0;i<data.rank.length;i++){if(data.rank[i].cid==F.context("cid")){T("#btn_add_care").first().removeClass("btn_add_care");T("#btn_add_care").first().removeClass("btn_care_enough");T("#btn_add_care").first().addClass("btn_have_cared")}}}}});return exports},["/static/common/lib/tangram/base/base.js","/static/common/ui/set-care-field/set-care-field.js","/static/common/ui/log/log.js"]);
F.module("/static/widget/browse/rank/rank.js",function(c,a){var b=c("/static/common/lib/tangram/base/base.js"),e=c("/static/common/lib/magic/setup/tab/tab.js"),g=F.context("cid");var d=window.iknow||{};d.teamData=function(l){var h=b(".team").first();var k="";for(var j=0;j<l.length&&j<5;j++){if(j==0){k+='<div class="ql-rank-one">';k+='<div class="ql-rank-l">';k+='<a rel="nofollow" href="/team/view/'+encodeURIComponent(l[j]["teamNameUrl"])+'">';k+='<img style="*margin:0 auto 5px;" width="55" height="55" onerror="this.src=\'http://img.baidu.com/img/iknow/userteam/onerror-s.jpg\'" src="'+l[j]["picUrl"]+'">';k+='</a><a rel="nofollow" class="fixdask-e btn btn-24-white" rel="{%$user.expertName%}" target="_blank" href="/new?teamid='+encodeURIComponent(l[j]["teamId"])+"&ta="+encodeURIComponent(l[j]["teamName"])+'"><em><b><span>求助团队</span></b></em></a>';k+="</div>";k+='<div class="ql-rank-r">';k+='<a rel="nofollow" alog-action="br-cate-expert" href="/team/view/'+encodeURIComponent(l[j]["teamNameUrl"])+'" target="_blank"><h4 style="font-weight:normal">'+l[j]["teamName"]+"</h4></a>";k+="<p>上周上升："+l[j]["scoreDiff"]+"</p>";k+="<p>最佳答案："+l[j]["resolveNum"]+"</p>";k+="<p>采纳率："+l[j]["ratio"]+"%</p>";k+="</div>";k+="</div>"}else{k+='<div class="ql-exp-item" style="zoom:1">';k+='<dl style="height:auto">';k+='<dt class="exp-rank'+j+'">';k+='<a alog-action="br-cate-expert" rel="nofollow" href="/team/view/'+encodeURIComponent(l[j]["teamNameUrl"])+'" target="_blank">'+l[j]["teamName"]+"</a>";k+="</dt>";k+="</dl>";k+="</div>"}}h.html(k)};window.iknow=d;var f="http://zhidao.baidu.com";b.sio.callByBrowser(f+"/team/api/qlteams?cid="+g+"&t="+((new Date()).getTime()),function(){});b.get("/browse/ajax/mingren/?cid="+g,function(k){k=b.json.parse(k).data;if(!k){return}var j=b("#mingren-table-list tbody"),i,l;if(k.users){b.forEach(k.users,function(n,m){i=b("<tr></tr>").get(0);l=b('<td width="55%"></td>').get(0);var o="http://www.baidu.com/p/"+n.userName+"?from=zhidao";l.innerHTML=['<a target="_blank" rel="nofollow" href="'+o+'"style="white-space:nowrap">',b.string.encodeHTML(n.userName),"</a>"].join("");i.appendChild(l);l=b('<td align="center"></td>').get(0);l.innerHTML=n.score;i.appendChild(l);j.append(i)})}if(k.more){var h=b("<tr></tr>"),l=b('<td colspan="2"></td>');l.html(['<a target="_blank" rel="nofollow" href="/misc/mingrentop?cid=',g,'">更多&gt;&gt;</a>'].join(""));h.append(l);j.append(h)}},"html");b.get("/browse/ajax/daren/?cid="+g,function(k){k=b.json.parse(k).data;if(!k){return}var j=b("#daren-table-list tbody"),i,l;if(k.users){b.forEach(k.users,function(n,m){i=b("<tr></tr>");l=b("<td></td>");var o="http://www.baidu.com/p/"+n.userName+"?from=zhidao";l.html(['<a target="_blank" rel="nofollow" href="'+o+'"style="white-space:nowrap">',b.string.encodeHTML(n.userName),"</a>"].join(""));i.append(l);l=b('<td align="center"></td>');l.html(['<span class="status',n.userStatus,'">&nbsp;</span>'].join(""));i.append(l);l=b('<td align="center"></td>');l.html(n.score);i.append(l);j.append(i)})}if(k.more){var h=b("<tr></tr>"),l=b('<td colspan="2"></td>');l.html(['<a target="_blank" rel="nofollow" href="/misc/darentop?cid=',g,'">更多&gt;&gt;</a>'].join(""));h.append(l);j.append(h)}},"html");e("rank-tab",{selectEvent:"mouseover"});a={};return a},["/static/common/lib/tangram/base/base.js","/static/common/lib/magic/setup/tab/tab.js"]);
F.module("/static/widget/browse/reply/reply.js",function(c,a){var b=c("/static/common/lib/tangram/base/base.js"),d=c("/static/common/ui/dialog/dialog.js");a.init=function(){b.sio("/uadmin/check/apply?t="+new Date().getTime()).callByServer(function(e){var f={okText:"确定",titleText:"提示",height:150,width:300};if(e.code==1){window.open("/html/adminUser/adminApplyDes.html","_blank")}else{d.alert(e.info.msg,f)}})};return a},["/static/common/lib/tangram/base/base.js","/static/common/ui/dialog/dialog.js"]);